import{r as n,u as I,j as e,B as i,S as A,L as F}from"./index-CQkseoub.js";import{T as r,B as w,V as d,I as R,a as W,H as x}from"./index-DnOH25_p.js";import{a as L}from"./authService-QIs4pFaF.js";import{F as g,G as M,a as C}from"./grid-item-BoZ8CjQk.js";function N({isOpen:o,onClose:h,onCreate:m,initialTitle:p="",initialRole:f="Mediator"}){const[j,b]=n.useState(p),[v,y]=n.useState(f),[u,z]=n.useState(!1),D=I();n.useEffect(()=>{o&&(b(p||""),y(f||"Mediator"))},[o]);const l=async t=>{t?.preventDefault?.();const a=(j||"").trim();if(!a){typeof window<"u"&&window.alert("Please enter a title for your disagreement.");return}let S=null;try{const s=localStorage.getItem("user");s&&(S=JSON.parse(s)?.token)}catch{}if(!S){typeof window<"u"&&window.alert("You must be logged in to create a disagreement.");return}try{z(!0);const c=(await W.post("http://localhost:3000/api/disagreements",{text:a},{headers:{Authorization:`Bearer ${S}`}}))?.data,k=c?._id||c?.id;if(typeof m=="function")try{m({title:a,role:v,created:c})}catch{}typeof h=="function"&&h(),k?D(`/disagreement/${k}`):typeof window<"u"&&window.alert("Created, but could not navigate to the new disagreement.")}catch(s){const c=s&&s.response&&s.response.data&&s.response.data.message||s?.message||"Failed to create disagreement";typeof window<"u"&&window.alert(`Create failed: ${c}`)}finally{z(!1)}};return o?e.jsxs(i,{position:"fixed",top:"0",right:"0",bottom:"0",left:"0",zIndex:1e3,children:[e.jsx(i,{position:"absolute",top:"0",right:"0",bottom:"0",left:"0",bg:"rgba(0,0,0,0.45)",onClick:h}),e.jsx(g,{position:"absolute",top:"0",right:"0",bottom:"0",left:"0",align:"center",justify:"center",p:4,children:e.jsxs(i,{as:"form",onSubmit:l,bg:"white",borderRadius:"xl",boxShadow:"xl",w:"100%",maxW:"lg",p:6,children:[e.jsxs(g,{align:"center",justify:"space-between",mb:4,children:[e.jsx(r,{as:"h2",fontSize:"xl",fontWeight:"semibold",children:"Start a New Disagreement"}),e.jsx(w,{variant:"ghost",size:"sm",onClick:h,children:"Close"})]}),e.jsxs(d,{align:"stretch",spacing:4,children:[e.jsxs(d,{align:"stretch",spacing:1,children:[e.jsx(r,{fontWeight:"medium",children:"Title"}),e.jsx(R,{placeholder:"e.g., Project Scope Discussion",value:j,onChange:t=>b(t.target.value),required:!0})]}),e.jsxs(d,{align:"stretch",spacing:1,children:[e.jsx(r,{fontWeight:"medium",children:"Select AI Role"}),e.jsxs(i,{as:"select",value:v,onChange:t=>y(t.target.value),required:!0,borderWidth:"1px",borderRadius:"md",p:2,children:[e.jsx("option",{value:"Mediator",children:"Mediator"}),e.jsx("option",{value:"Fact-Finder",children:"Fact-Finder"}),e.jsx("option",{value:"Judge & Jury",children:"Judge & Jury"})]})]})]}),e.jsxs(g,{justify:"flex-end",gap:3,mt:6,children:[e.jsx(w,{variant:"ghost",onClick:h,disabled:u,children:"Cancel"}),e.jsx(w,{colorScheme:"blue",type:"submit",isDisabled:u,isLoading:u,children:"Create"})]})]})})]}):null}function B(){const o=I(),[h,m]=n.useState(!0),[p,f]=n.useState(""),[j,b]=n.useState([]),[v,y]=n.useState(!1),u=()=>y(!0),z=()=>y(!1);n.useEffect(()=>{try{const t=localStorage.getItem("user");if(!t){o("/login",{replace:!0});return}JSON.parse(t)}catch{localStorage.removeItem("user"),o("/login",{replace:!0})}},[o]),n.useEffect(()=>{(async()=>{const a=localStorage.getItem("user");if(!a)return;const S=JSON.parse(a);try{m(!0),f("");const s=await W.get("http://localhost:3000/api/disagreements",{headers:{Authorization:`Bearer ${S.token}`}});b(Array.isArray(s.data)?s.data:[])}catch(s){const c=s&&s.response&&s.response.data&&s.response.data.message||s?.message||"Failed to load disagreements";f(c)}finally{m(!1)}})()},[]);const D=()=>{L.logout(),o("/login",{replace:!0})},l=({children:t,...a})=>e.jsx(i,{bg:"white",borderRadius:"2xl",boxShadow:"lg",p:{base:4,md:6},...a,children:t});return e.jsx(i,{minH:"100vh",bg:"gray.50",px:{base:4,md:8},py:{base:6,md:10},children:e.jsxs(d,{maxW:"6xl",mx:"auto",spacing:8,align:"stretch",children:[e.jsxs(g,{align:"center",justify:"space-between",children:[e.jsx(x,{size:"xl",letterSpacing:"tight",children:"Your Dashboard"}),e.jsx(w,{colorScheme:"gray",variant:"outline",onClick:D,children:"Logout"})]}),h?e.jsx(l,{children:e.jsx(g,{align:"center",justify:"center",minH:"200px",children:e.jsx(A,{size:"lg",thickness:"3px",color:"blue.500"})})}):p?e.jsx(l,{children:e.jsx(r,{color:"red.500",fontWeight:"medium",textAlign:"center",children:p})}):e.jsxs(M,{templateColumns:{base:"1fr",md:"repeat(2, 1fr)"},gap:{base:4,md:6},children:[e.jsx(C,{colSpan:{base:1,md:2},children:e.jsxs(l,{children:[e.jsx(x,{as:"h2",size:"md",mb:4,children:"Active Disagreements"}),j.length===0?e.jsxs(g,{direction:"column",align:"center",justify:"center",py:10,color:"gray.600",children:[e.jsx(r,{fontSize:"4xl","aria-hidden":!0,children:"ðŸ“­"}),e.jsx(r,{mt:3,textAlign:"center",children:"You have no active disagreements. Create one to get started!"}),e.jsx(w,{colorScheme:"blue",size:"lg",mt:6,onClick:u,children:"Create New Disagreement"})]}):e.jsx(i,{maxH:{base:"unset",md:"320px"},overflowY:"auto",pr:1,children:e.jsx(d,{spacing:3,align:"stretch",children:j.map(t=>e.jsxs(i,{as:F,to:`/disagreement/${t._id}`,borderWidth:"1px",borderRadius:"lg",p:4,_hover:{bg:"gray.50",shadow:"md",transform:"translateY(-2px)"},transition:"all 0.2s ease",cursor:"pointer",children:[e.jsx(x,{size:"sm",noOfLines:1,children:t.text||"Untitled Disagreement"}),e.jsx(r,{color:"gray.600",mt:1,noOfLines:1,children:"Participants: You"})]},t._id))})})]})}),e.jsx(C,{children:e.jsx(l,{role:"button",onClick:u,_hover:{shadow:"xl",transform:"translateY(-2px)"},transition:"all 0.2s ease",children:e.jsxs(d,{align:"start",spacing:2,children:[e.jsx(i,{w:10,h:10,borderRadius:"full",bg:"#5D5FEF",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"2xl","aria-hidden":!0,children:"+"}),e.jsx(x,{as:"h3",size:"md",children:"New Disagreement"}),e.jsx(r,{color:"gray.600",children:"Start a new resolution process."})]})})}),e.jsx(C,{children:e.jsxs(l,{children:[e.jsx(x,{as:"h3",size:"md",mb:4,children:"My Stats"}),e.jsxs(g,{gap:8,wrap:"wrap",children:[e.jsxs(d,{align:"start",spacing:0,minW:"140px",children:[e.jsx(r,{fontSize:"sm",color:"gray.600",children:"Cases Resolved"}),e.jsx(r,{fontSize:"3xl",fontWeight:"bold",children:"0"})]}),e.jsxs(d,{align:"start",spacing:0,minW:"140px",children:[e.jsx(r,{fontSize:"sm",color:"gray.600",children:"Success Rate"}),e.jsx(r,{fontSize:"3xl",fontWeight:"bold",children:"N/A"})]})]})]})}),e.jsx(C,{colSpan:{base:1,md:2},children:e.jsxs(l,{children:[e.jsx(x,{as:"h3",size:"md",mb:2,children:"Recent Activity"}),e.jsx(r,{color:"gray.600",children:"Activity feed coming soon."})]})})]}),e.jsx(N,{isOpen:v,onClose:z,onCreate:({created:t})=>{t&&b(a=>[t,...a])}})]})})}export{B as default};
