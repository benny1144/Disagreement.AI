import{r as i,u as D,j as e,B as b,L as I}from"./index-CEQxUotr.js";import{a as k}from"./index-ngrFHoWO.js";import{a as A}from"./authService-BFopl1YD.js";import{F as v,T as N,B as y,V as S,I as F}from"./v-stack-aeNpo7zc.js";function L({isOpen:n,onClose:l,onCreate:c,initialTitle:x="",initialRole:m="Mediator"}){const[h,u]=i.useState(x),[p,g]=i.useState(m),[o,j]=i.useState(!1),w=D();i.useEffect(()=>{n&&(u(x||""),g(m||"Mediator"))},[n]);const t=async r=>{r?.preventDefault?.();const f=(h||"").trim();if(!f){typeof window<"u"&&window.alert("Please enter a title for your disagreement.");return}let s=null;try{const a=localStorage.getItem("user");a&&(s=JSON.parse(a)?.token)}catch{}if(!s){typeof window<"u"&&window.alert("You must be logged in to create a disagreement.");return}try{j(!0);const d=(await k.post("http://localhost:3000/api/disagreements",{text:f},{headers:{Authorization:`Bearer ${s}`}}))?.data,C=d?._id||d?.id;if(typeof c=="function")try{c({title:f,role:p,created:d})}catch{}typeof l=="function"&&l(),C?w(`/disagreement/${C}`):typeof window<"u"&&window.alert("Created, but could not navigate to the new disagreement.")}catch(a){const d=a&&a.response&&a.response.data&&a.response.data.message||a?.message||"Failed to create disagreement";typeof window<"u"&&window.alert(`Create failed: ${d}`)}finally{j(!1)}};return n?e.jsxs(b,{position:"fixed",top:"0",right:"0",bottom:"0",left:"0",zIndex:1e3,children:[e.jsx(b,{position:"absolute",top:"0",right:"0",bottom:"0",left:"0",bg:"rgba(0,0,0,0.45)",onClick:l}),e.jsx(v,{position:"absolute",top:"0",right:"0",bottom:"0",left:"0",align:"center",justify:"center",p:4,children:e.jsxs(b,{as:"form",onSubmit:t,bg:"white",borderRadius:"xl",boxShadow:"xl",w:"100%",maxW:"lg",p:6,children:[e.jsxs(v,{align:"center",justify:"space-between",mb:4,children:[e.jsx(N,{as:"h2",fontSize:"xl",fontWeight:"semibold",children:"Start a New Disagreement"}),e.jsx(y,{variant:"ghost",size:"sm",onClick:l,children:"Close"})]}),e.jsxs(S,{align:"stretch",spacing:4,children:[e.jsxs(S,{align:"stretch",spacing:1,children:[e.jsx(N,{fontWeight:"medium",children:"Title"}),e.jsx(F,{placeholder:"e.g., Project Scope Discussion",value:h,onChange:r=>u(r.target.value),required:!0})]}),e.jsxs(S,{align:"stretch",spacing:1,children:[e.jsx(N,{fontWeight:"medium",children:"Select AI Role"}),e.jsxs(b,{as:"select",value:p,onChange:r=>g(r.target.value),required:!0,borderWidth:"1px",borderRadius:"md",p:2,children:[e.jsx("option",{value:"Mediator",children:"Mediator"}),e.jsx("option",{value:"Fact-Finder",children:"Fact-Finder"}),e.jsx("option",{value:"Judge & Jury",children:"Judge & Jury"})]})]})]}),e.jsxs(v,{justify:"flex-end",gap:3,mt:6,children:[e.jsx(y,{variant:"ghost",onClick:l,disabled:o,children:"Cancel"}),e.jsx(y,{colorScheme:"blue",type:"submit",isDisabled:o,isLoading:o,children:"Create"})]})]})})]}):null}function E(){const n=D(),[l,c]=i.useState(!0),[x,m]=i.useState(""),[h,u]=i.useState([]),[p,g]=i.useState(!1),o=()=>g(!0),j=()=>g(!1);i.useEffect(()=>{try{const t=localStorage.getItem("user");if(!t){n("/login",{replace:!0});return}JSON.parse(t)}catch{localStorage.removeItem("user"),n("/login",{replace:!0})}},[n]),i.useEffect(()=>{(async()=>{const r=localStorage.getItem("user");if(!r)return;const f=JSON.parse(r);try{c(!0),m("");const s=await k.get("http://localhost:3000/api/disagreements",{headers:{Authorization:`Bearer ${f.token}`}});u(Array.isArray(s.data)?s.data:[])}catch(s){const a=s&&s.response&&s.response.data&&s.response.data.message||s?.message||"Failed to load disagreements";m(a)}finally{c(!1)}})()},[]);const w=()=>{A.logout(),n("/login",{replace:!0})};return e.jsx("div",{className:"min-h-screen bg-white px-4 md:px-8 py-6 md:py-10 font-sans",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"Your Dashboard"}),e.jsx("button",{onClick:w,className:"px-4 py-2 rounded-md border border-slate-300 text-slate-700 hover:bg-slate-50 text-lg",children:"Logout"})]}),l?e.jsx("div",{className:"bg-white rounded-2xl shadow p-8 flex items-center justify-center min-h-[200px]",children:e.jsx("span",{className:"text-slate-500 text-lg",children:"Loadingâ€¦"})}):x?e.jsx("div",{className:"bg-white rounded-2xl shadow p-6",children:e.jsx("p",{className:"text-red-600 font-semibold text-center",children:x})}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"md:col-span-2 bg-white rounded-2xl shadow p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-4",children:"Active Disagreements"}),h.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center text-slate-600 py-10",children:[e.jsx("div",{className:"text-5xl","aria-hidden":!0,children:"ðŸ“­"}),e.jsx("p",{className:"text-lg mt-3 text-center",children:"You have no active disagreements. Create one to get started!"}),e.jsx("button",{onClick:o,className:"mt-6 inline-flex items-center justify-center rounded-md bg-blue-600 text-white font-semibold shadow-sm hover:bg-blue-500 px-5 py-2.5 text-lg",children:"Create New Disagreement"})]}):e.jsx("div",{className:"max-h-80 overflow-y-auto pr-1",children:e.jsx("ul",{className:"space-y-3",children:h.map(t=>e.jsx("li",{children:e.jsxs(I,{to:`/disagreement/${t._id}`,className:"block border border-slate-200 rounded-lg p-4 hover:bg-slate-50 hover:shadow-md transition-all",children:[e.jsx("div",{className:"text-base md:text-lg font-bold text-slate-800 truncate",children:t.text||"Untitled Disagreement"}),e.jsx("div",{className:"text-slate-600 mt-1 text-sm md:text-base",children:"Participants: You"})]})},t._id))})})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow p-6 hover:shadow-xl transition-all cursor-pointer",onClick:o,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center text-2xl","aria-hidden":!0,children:"+"}),e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"New Disagreement"}),e.jsx("p",{className:"text-slate-600",children:"Start a new resolution process."})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"My Stats"}),e.jsxs("div",{className:"flex gap-8 flex-wrap",children:[e.jsxs("div",{className:"min-w-[140px]",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Cases Resolved"}),e.jsx("div",{className:"text-3xl font-bold text-slate-800",children:"0"})]}),e.jsxs("div",{className:"min-w-[140px]",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Success Rate"}),e.jsx("div",{className:"text-3xl font-bold text-slate-800",children:"N/A"})]})]})]}),e.jsxs("div",{className:"md:col-span-2 bg-white rounded-2xl shadow p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Recent Activity"}),e.jsx("p",{className:"text-slate-600",children:"Activity feed coming soon."})]})]}),e.jsx(L,{isOpen:p,onClose:j,onCreate:({created:t})=>{t&&u(r=>[t,...r])}})]})})}export{E as default};
